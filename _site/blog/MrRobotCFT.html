<!DOCTYPE html>
<html>
<head>
  <head>
    <!-- Include Meta Tags Here -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1 user-scalable=no, shrink-to-fit=no">
<meta content='#000000' name='theme-color'/>
<meta name="keywords" content="Site, Template, Theme">
<title>CyberWiki | Mr Robot CTF</title>

<!-- Open Graph general (Facebook, Pinterest & Google+) -->
<meta name="og:title" content="CyberWiki | Mr Robot CTF">
<meta name="og:description" content="Esta room se basa en la serie de Mr. Robot. Se realiza un escaneo de puertos, se descubren directorios ocultos, se encuentra una clave en el archivo robots.txt, se obtienen credenciales de acceso a un panel de login de WordPress, se realiza una revershell PHP para obtener acceso remoto, se encuentran y se obtienen claves adicionales, se descifra una contraseña encriptada, se escalan privilegios a root y se encuentra la última clave para completar el ejercicio.">
<meta name="og:image" content="../assets/images/Rooms/MrRobotCTF/mr.png">
<meta name="og:image:alt" content="CyberWiki | Mr Robot CTF">
<meta name="og:url" content="http://localhost:4000/blog/MrRobotCFT">
<meta name="article:author" content="https://www.facebook.com/">
<meta name="og:site_name" content="CyberWiki | Mr Robot CTF">
<meta name="og:type" content="website">
<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image"/>
<meta name="twitter:title" content="CyberWiki | Mr Robot CTF">
<meta name="twitter:description" content="Esta room se basa en la serie de Mr. Robot. Se realiza un escaneo de puertos, se descubren directorios ocultos, se encuentra una clave en el archivo robots.txt, se obtienen credenciales de acceso a un panel de login de WordPress, se realiza una revershell PHP para obtener acceso remoto, se encuentran y se obtienen claves adicionales, se descifra una contraseña encriptada, se escalan privilegios a root y se encuentra la última clave para completar el ejercicio.">
<meta name="twitter:site" content="@">
<meta name="twitter:creator" content="@">
<meta name="twitter:image:src" content="../assets/images/Rooms/MrRobotCTF/mr.png">
<!-- Search Engine -->
<meta name="description" content="Esta room se basa en la serie de Mr. Robot. Se realiza un escaneo de puertos, se descubren directorios ocultos, se encuentra una clave en el archivo robots.txt, se obtienen credenciales de acceso a un panel de login de WordPress, se realiza una revershell PHP para obtener acceso remoto, se encuentran y se obtienen claves adicionales, se descifra una contraseña encriptada, se escalan privilegios a root y se encuentra la última clave para completar el ejercicio.">
<meta name="image" content="../assets/images/Rooms/MrRobotCTF/mr.png">
<!-- Schema.org for Google -->
<meta itemprop="name" content="CyberWiki | Mr Robot CTF">
<meta name="author" content="Jose Luis Venega"/>
<meta itemprop="description" content="Esta room se basa en la serie de Mr. Robot. Se realiza un escaneo de puertos, se descubren directorios ocultos, se encuentra una clave en el archivo robots.txt, se obtienen credenciales de acceso a un panel de login de WordPress, se realiza una revershell PHP para obtener acceso remoto, se encuentran y se obtienen claves adicionales, se descifra una contraseña encriptada, se escalan privilegios a root y se encuentra la última clave para completar el ejercicio.">
<meta itemprop="image" content="../assets/images/Rooms/MrRobotCTF/mr.png">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', '');
</script>
    <title>CyberWiki</title>
    <link rel="stylesheet" href="/assets/css/style.css">
      <!-- Incluye el CSS de Prism.js -->
    <link rel="stylesheet" href="../prism.css">
    <script src="https://kit.fontawesome.com/6a97161b76.js" crossorigin="anonymous"></script>
    <link rel="shortcut icon" href="/assets/images/favicon.png" type="image/x-icon">
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            var titleElement = document.getElementById('page-title');
            var icon = "/assest/images/favicon.png"; // Puedes usar cualquier emoji o icono aquí
            titleElement.textContent = icon + " " + titleElement.textContent;
        });
    </script>
</head>
</head>



<body>
  <nav class="navbar is-black is-fixed-top" role="navigation" aria-label="main navigation" id="navbar">
    <div class="container">

        <!-- logo or branding image on left side -->
       
        <!-- Logo o imagen de marca en el lado izquierdo -->
        <div class="navbar-brand">
            <a class="navbar-item"
            href="http://localhost:4000/">
            <img src="/assets/images/favicon.png" alt="Site Icon" style="width: 24px; height: 24px; vertical-align: middle;">
                <i class="/assest/images/favicon.png"></i> <!-- Icono  -->
                <strong>CyberWiki</strong>
            </a>
            <div class="navbar-burger" data-target="navbar-menu">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>

        <!-- children of navbar-menu must be navbar-start and/or navbar-end -->
        <div class="navbar-menu has-background-black" id="navbar-menu">
            <!-- navbar items | left side -->
            <!-- <div class="navbar-start">
            </div> -->
            <!-- navbar items | right side -->
            <div class="navbar-end">
                <a class="navbar-item "
                    href="http://localhost:4000/">HOME</a>
                <a class="navbar-item" href="http://localhost:4000/#about">ABOUT</a>
                <a class="navbar-item" href="http://localhost:4000/#contact">CONTACT</a>
                <a class="navbar-item "
                    href="http://localhost:4000/blog">WRITE-UPs</a>
                <a class="navbar-item "
                    href="http://localhost:4000/project">LABS</a>
                <!-- <div class="navbar-item has-dropdown is-hoverable">
    <a class="navbar-link">
        MORE
    </a>
    <div class="navbar-dropdown has-background-black is-left">
        
        
        
        
        
        
        
        
        <a href="http://localhost:4000/project"
            class="navbar-item has-text-grey-light ">
            Projects
        </a>
        
        
        
        <a href="http://localhost:4000/test-page"
            class="navbar-item has-text-grey-light ">
            Test Page
        </a>
        
         -->
        <!-- <hr class="navbar-divider">
    <a class="navbar-item">
      Report an issue
    </a> -->
    <!-- </div>
</div> -->
            </div>
        </div>
    </div>
</nav>
<!-- Bulma Navbar JS -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        /* Get all "navbar-burger" elements */
        var $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);
        /* Check if there are any navbar burgers */
        if ($navbarBurgers.length > 0) {
            /* Add a click event on each of them */
            $navbarBurgers.forEach(function ($el) {
                $el.addEventListener('click', function () {
                    /* Get the target from the "data-target" attribute */
                    var target = $el.dataset.target;
                    var $target = document.getElementById(target);
                    /* Toggle the class on both the "navbar-burger" and the "navbar-menu" */
                    $el.classList.toggle('is-active');
                    $target.classList.toggle('is-active');
                });
            });
        }
    });
</script>
  <section class="hero is-fullheight has-text-centered" id="post">
    <div class="hero-body">
      <div class="container">
        <a href="/blog/MrRobotCFT" class="has-text-black" id="title">
          <h1 class="title has-text-centered is-2 has-text-weight-semibold ">Mr Robot CTF</h1>
        </a>
        <hr class="has-background-black">
        <div class="columns is-variable is-5 has-text-centered">
          <div class="column is-6">
            <div style="text-align: center; ">
              <img src="../assets/images/Rooms/MrRobotCTF/mr.png" alt="Mr Robot CTF" id="post-image">
            </div>
          </div>
          <div class="subtitle column is-5 has-text-left-desktop has-text-left-fullhd has-text-left-tablet has-text-center-mobile" style="text-align: left;" ">
            
            <p id="description" class="content is-small has-text-weight-medium is-uppercase">
              Esta room se basa en la serie de Mr. Robot. Se realiza un escaneo de puertos, se descubren directorios ocultos, se encuentra una clave en el archivo robots.txt, se obtienen credenciales de acceso a un panel de login de WordPress, se realiza una revershell PHP para obtener acceso remoto, se encuentran y se obtienen claves adicionales, se descifra una contraseña encriptada, se escalan privilegios a root y se encuentra la última clave para completar el ejercicio.
              <!-- Enlace añadido aquí -->
              <p class="subtitle is-uppercase is-6 has-text-weight-normal has-text-black-ter">LAB LINK: 
                <b><a href="https://tryhackme.com/r/room/mrrobot" target="page.enlace">Mr Robot CTF</a></b>
              </p>
                
              <p class="subtitle is-6 is-uppercase has-text-weight-normal has-text-black-ter">LAB difficulty: 
                <b>Media</b>
              </p>
            <p class="subtitle is-6 is-uppercase has-text-weight-normal has-text-black-ter">Published on
              <b>August 02, 2024</b> by <a href="https://github.com/Joseeelv" target="_blank"><b class="has-text-link"><u>Jose Luis Venega</u></b>
              </a>
            </p><p class="subtitle is-uppercase">
              <i class="fas fa-tags"></i>
              
              
              <span class="tag is-link">Enumeración</span>
              
              
              <span class="tag is-link">Exploit</span>
              
              
              <span class="tag is-link">Fuerza-bruta</span>
              
              
              <span class="tag is-link">Hash cracking</span>
              
              
              <span class="tag is-link">Web</span>
              
              
            </p><!-- <p class="subtitle is-uppercase"><i class="fas fa-clock"></i> <b class="has-text-link">
                4 min
              </b>READ</p> --></div>
        </div>
        <div class="content has-text-justified-desktop has-text-justified-fullhd has-text-justified has-text-justified-tablet has-text-left-mobile">
          <p><h1 id="proceso-para-conseguir-la-usertxt">Proceso para conseguir la user.txt:</h1>
<p>Vamos a realizar un escaneo de puertos desde la maquina atacante:</p>

<div style="text-align:center;">
 <div class="code-container">
    <div class="code-header">
      Bash
      <button class="copy-button" data-code="bash">Copiar</button>
    </div>
    <pre><code class="language-bash">sudo nmap -p- -open -sV -sC -sS --min-rate 5000 -n -Pn -vvv ip_victima</code></pre>
  </div>
</div>

<p>Hemos obtenido:</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled1.png" alt="Untitled" onclick="openModal(this.src)" />
  </div>

<p>Tenemos dos protocolos http (80) y https(443), podemos acceder a ella introduciendo la ip en la barra del buscador de nuestro navegador.</p>

<p>Vamos ver si hay directorios ocultos, mediante fuzzing con gobuster:</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled2.png" alt="Untitled" onclick="openModal(this.src)" />
  </div>

<p>Y vamos a ver que directorios escondidos tiene la pagina web:</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled3.png" alt="Untitled" onclick="openModal(this.src)" />
  </div>

<p>Primero de todo, toda página web contiene el directorio <em>/robots.txt</em> por tanto vamos a echarle un ojo:</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 4.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Encontramos la primera key, que la podemos ver accediendo desde la barra de navegación o haciendo un curl desde la consola:</p>
<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 5.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Hemos encontrado un directorio <em>/dashboard</em> que en verdad es el directorio admin de un wordpress <em>/wp-admin</em> vamos a hacerle un curl a ver que enconrtamos:</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 6.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Encontramos un panel de login, para ello necesitamos obtener un user y contraseña.</p>

<p>También hemos encontrado un directorio <em>license</em> que si accedemos a el vamos a encontrar al final del todo una contraseña, hacemos un curl a dicho directorio y obtenemos el user y la contraseña:</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 7.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Está en base64 , por tanto, vamos a convertirlo y obtenemos la contraseña y el usuario</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 8.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Ahí tenemos las credenciales, vamos a iniciar sesión:</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 8.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Estamos dentro, ahora vamos a proceder a buscar las demás keys.</p>

<p>Como sabemos wordpress corre bajo php, por tanto, vamos a realizar una revershell php para poder acceder y tener ejecución remota de comandos, mediante un script encontrado en github <a href="https://github.com/pentestmonkey/php-reverse-shell">Pentestmonkey-php-reverse-shell</a></p>

<p>Ahora pegamos el script encontrado en github en la seccion Appearance → editor →archive:</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 10.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Ahora abrimos un puerto para realizar la escucha mediante netcat y modificamos el script introducido anteriormente con nuestra IP y el puerto seleccionado para realizar la escucha:</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 11.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 12.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Realizamos la revershell y estamos dentro.</p>

<p>Ahora vamos a buscar las demás keys, vamos a comprobar que una de ellas sea del tipo .txt, por tanto vamos a buscarla.</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 13.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Buscamos todos los archivos que terminen en la extensión .txt, y vemos que en el directorio <em>/home</em> encontramos la segunda key.</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 14.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Hacemos un cat para obtenerla, pero nos dice que no tenemos permisos y en efecto, solamente tiene permiso de lectura el root.</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 15.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Además de la key, el home encontramos otro fichero, que es una password:</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 16.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p><a href="https://crackstation.net/">Crackstation</a>:</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 17.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Ahí tenemos nuestra contraseña, para poder escalar de privilegios a root.</p>

<p>Ahora hacemos sudo su y ponemos la password.</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 18.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Primero hacemos un tratamiento de la tty, para poder escribir el comando su, para escalar privilegios.</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 19.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>ahora somos robot y podemos acceder a la segunda key.</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 20.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Ahora para encontrar la tercera y ultima key, lo que vamos a hacer es tirar otro find donde el nombre sea key-3-of-3.txt, para ver donde se ubica y nos aparece nada, por tanto vamos a buscar binarios:</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled 21.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Y encontramos uno que es muy raro que es el de nmap y buscamos una vulnerabilidad en gtfobins de nmap Sudo, para poder hacernos root:</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled22.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Vamos a hacer uso de la ocpión b:</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled23.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Y ya tenemos permisos root, para poder acceder a la tercera y última key, que se encuentra en /root/key-3-of-3.txt</p>

<div style="text-align: center; ">
    <img src="../assets/images/Rooms/MrRobotCTF/Untitled24.png" alt="Untitled" onclick="openModal(this.src)" />
</div>

<p>Listo, tenemos el ejercicio completado.</p>

<hr />
</p>
        </div>
        
        <div class="disqus-comments" id="disqus_thread"></div>
        
      </div>
    </div>
  </section>
  <footer id="footer">
    <!--Footer Button-->
    <div class="container has-text-centered has-background-grey-darker" id="backtotop">
        <a class="has-text-white" onclick="window.scroll(0,0)">BACK TO TOP</a>
    </div>
    <!--Footer Main Section-->
    <div class="has-background-grey-darker">
        <div class="container columns">
            <!--Name Section-->
            <div class="column has-text-left-desktop has-text-centered-mobile">
                <a href="http://localhost:4000/#about">
                    <div class="columns">
                        <div class="column is-one-fifth-desktop is-one-fifth-fullhd is-one-quarter-tablet">
                            <figure class="image is-64x64">
                                <img class="is-rounded" src="/assets/images/me.png">
                            </figure>
                        </div>
                        <div class="column is-marginless">
                            <h5 class="has-text-grey-lighter">Jose Luis Venega</h5>
                            <div class="content has-text-grey">
                                <p>Hello, I am Jose Luis Venega Sánchez, a student of Computer Engineering ...</p>
                            </div>
                        </div>
                    </div>
                </a>
            </div>

            <!--Link Section
            <div class="column has-text-white">
                <h3>More Links</h3>
                
                <li>
                    <a target="_blank" href="http://localhost:4000/feed.xml">Subscribe via RSS</a>
                </li>
            </div> -->

            <!--Blog-post Section-->
            <div class="column has-text-white">
                <h3>Recent Posts</h3>
                
                <li>
                    <a href="http://localhost:4000/blog/ChillHack">ChillHack</a>
                </li>
                
                <li>
                    <a href="http://localhost:4000/blog/DNS">Sistema de Nombres de Dominio "DNS"</a>
                </li>
                
                <li>
                    <a href="http://localhost:4000/blog/Startup">Start-up</a>
                </li>
                
            </div>
        </div>
    </div>
    <!-- <div class="has-background-black has-text-centered has-text-white" id="credits">
        <i class="far fa-copyright"></i> 2024 | <a href="https://github.com/thedevslot/WhatATheme" target="_blank" rel="noopener noreferrer">WhatATheme</a> - A Theme made with <i class="fas fa-heart has-text-danger"></i> by <a href="https://www.twitter.com/thedevslot" target="_blank" rel="noopener noreferrer">TheDevsLot</a> Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>
    </div> -->
</footer>

  <!-- Modal -->
  <div id="myModal" class="modal">
    <span class="close" onclick="closeModal()">&times;</span>
    <img class="modal-content" id="img01">
  </div>
 <!-- Prism.js Script -->
  <script src="../prism.js"></script>
  <script>
    function copyToClipboard(event) {
    // Obtén el botón que fue clickeado
    const button = event.target;

    // Encuentra el bloque de código asociado al botón
    const codeContainer = button.closest('.code-container');
    const codeElement = codeContainer.querySelector('code');
    
    if (!codeElement) {
        console.error('No se encontró el elemento <code> para copiar.');
        return;
    }

    const code = codeElement.textContent;

    // Usa la API moderna de Clipboard para copiar el texto
    navigator.clipboard.writeText(code).then(() => {
        // Cambia el texto del botón a 'Copiado'
        button.textContent = 'Copied!';

        // Opcional: Restaura el texto del botón después de un breve período
        setTimeout(() => {
            button.textContent = 'Copy';
        }, 2000); // 2000 ms = 2 segundos

    }).catch(err => {
        // Maneja errores (opcional)
        console.error('Error al copiar al portapapeles: ', err);
    });
}
        document.querySelectorAll('.copy-button').forEach(button => {
          button.addEventListener('click', copyToClipboard);
        });
      function openModal(imgSrc) {
      var modal = document.getElementById("myModal");
      var modalImg = document.getElementById("img01");

      modal.style.display = "block";
      setTimeout(function() {
        modal.classList.add('show');
      }, 10); // Delay to trigger the animation
      modalImg.src = imgSrc;
    }

    function closeModal(event) {
      if (event) event.stopPropagation(); // Prevents closing when clicking the close button
      var modal = document.getElementById("myModal");
      modal.classList.remove('show');
      setTimeout(function() {
        modal.style.display = "none";
      }, 300); // Match this duration with the CSS animation duration
    }

    // Close modal when clicking outside the content
    window.onclick = function(event) {
      var modal = document.getElementById("myModal");
      if (event.target == modal) {
        closeModal();
      }
    }
  </script>
</body>
</html>
