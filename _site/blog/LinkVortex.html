<!DOCTYPE html>
<html>
<head>
  <head>
    <!-- Include Meta Tags Here -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1 user-scalable=no, shrink-to-fit=no">
<meta content='#000000' name='theme-color'/>
<meta name="keywords" content="Site, Template, Theme">
<title>Jose's Portfolio | LinkVortex</title>

<!-- Open Graph general (Facebook, Pinterest & Google+) -->
<meta name="og:title" content="Jose's Portfolio | LinkVortex">
<meta name="og:description" content="LinkVortex machine from Hack The Box. The process includes port scanning, web technology identification, fuzzing for hidden directories, exploiting vulnerabilities in Ghost CMS (CVE-2023-40028), and privilege escalation through the clean_symlink.sh script. The final goal was to escalate privileges and capture the root flag.">
<meta name="og:image" content="/assets/images/Rooms/HTB/LinkVortex/LinkVortex.png">
<meta name="og:image:alt" content="Jose's Portfolio | LinkVortex">
<meta name="og:url" content="http://localhost:4000/blog/LinkVortex">
<meta name="article:author" content="https://www.facebook.com/">
<meta name="og:site_name" content="Jose's Portfolio | LinkVortex">
<meta name="og:type" content="website">
<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image"/>
<meta name="twitter:title" content="Jose's Portfolio | LinkVortex">
<meta name="twitter:description" content="LinkVortex machine from Hack The Box. The process includes port scanning, web technology identification, fuzzing for hidden directories, exploiting vulnerabilities in Ghost CMS (CVE-2023-40028), and privilege escalation through the clean_symlink.sh script. The final goal was to escalate privileges and capture the root flag.">
<meta name="twitter:site" content="@">
<meta name="twitter:creator" content="@">
<meta name="twitter:image:src" content="/assets/images/Rooms/HTB/LinkVortex/LinkVortex.png">
<!-- Search Engine -->
<meta name="description" content="LinkVortex machine from Hack The Box. The process includes port scanning, web technology identification, fuzzing for hidden directories, exploiting vulnerabilities in Ghost CMS (CVE-2023-40028), and privilege escalation through the clean_symlink.sh script. The final goal was to escalate privileges and capture the root flag.">
<meta name="image" content="/assets/images/Rooms/HTB/LinkVortex/LinkVortex.png">
<!-- Schema.org for Google -->
<meta itemprop="name" content="Jose's Portfolio | LinkVortex">
<meta name="author" content="Jose Luis Venega"/>
<meta itemprop="description" content="LinkVortex machine from Hack The Box. The process includes port scanning, web technology identification, fuzzing for hidden directories, exploiting vulnerabilities in Ghost CMS (CVE-2023-40028), and privilege escalation through the clean_symlink.sh script. The final goal was to escalate privileges and capture the root flag.">
<meta itemprop="image" content="/assets/images/Rooms/HTB/LinkVortex/LinkVortex.png">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', '');
</script>
    <title>Jose's Portfolio</title>
    <link rel="stylesheet" href="/assets/css/style.css">
      <!-- Incluye el CSS de Prism.js -->
    <link rel="stylesheet" href="../prism.css">
    <script src="https://kit.fontawesome.com/6a97161b76.js" crossorigin="anonymous"></script>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    
    <link rel="shortcut icon" href="/assets/images/favicon.png" type="image/x-icon">
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            var titleElement = document.getElementById('page-title');
            var icon = "/assest/images/favicon.png"; // Puedes usar cualquier emoji o icono aquí
            titleElement.textContent = icon + " " + titleElement.textContent;
        });
    </script>
</head>
</head>

<body>
  <nav class="navbar is-black is-fixed-top" role="navigation" aria-label="main navigation" id="navbar">
    <div class="container">

        <!-- logo or branding image on left side -->
       
        <!-- Logo o imagen de marca en el lado izquierdo -->
        <div class="navbar-brand">
            <a class="navbar-item"
                href="http://localhost:4000/">
                    <img src="/assets/images/favicon.png" 
                        alt="Site Icon" 
                        style="width: 24px; height: 24px; vertical-align: middle; margin-right: 8px;">
                    <i class="/assest/images/favicon.png"></i>
                    <strong>Jose's Portfolio</strong>
                </a>
            <div class="navbar-burger" data-target="navbar-menu">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>

        <!-- children of navbar-menu must be navbar-start and/or navbar-end -->
        <div class="navbar-menu has-background-black" id="navbar-menu">
            <!-- navbar items | left side -->
            <!-- <div class="navbar-start">
            </div> -->
            <!-- navbar items | right side -->
            <div class="navbar-end">
                <a class="navbar-item "
                    href="http://localhost:4000/">HOME</a>
                <a class="navbar-item" href="http://localhost:4000/#about">WHOAMI</a>
                <a class="navbar-item" href="http://localhost:4000/#contact">CONTACT</a>
                <a class="navbar-item "
                    href="http://localhost:4000/blog">MACHINES</a>
            </div>
        </div>
    </div>
</nav>
<!-- Bulma Navbar JS -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        /* Get all "navbar-burger" elements */
        var $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);
        /* Check if there are any navbar burgers */
        if ($navbarBurgers.length > 0) {
            /* Add a click event on each of them */
            $navbarBurgers.forEach(function ($el) {
                $el.addEventListener('click', function () {
                    /* Get the target from the "data-target" attribute */
                    var target = $el.dataset.target;
                    var $target = document.getElementById(target);
                    /* Toggle the class on both the "navbar-burger" and the "navbar-menu" */
                    $el.classList.toggle('is-active');
                    $target.classList.toggle('is-active');
                });
            });
        }
    });
</script>
  <section class="hero is-fullheight has-text-centered" id="post">
    <div class="hero-body">
      <div class="container">
        <a href="/blog/LinkVortex" class="has-text-black" id="title">
          <h1 class="title has-text-centered is-2 has-text-weight-semibold ">LinkVortex</h1>
        </a>
        <hr class="has-background-black">
        <div class="columns is-variable is-5 has-text-centered">
          <div class="column is-6">
            <div style="text-align: center;">
              <img src="/assets/images/Rooms/HTB/LinkVortex/LinkVortex.png" alt="LinkVortex" id="post-image">
            </div>
          </div>
          <div class="subtitle column is-5 has-text-left-desktop has-text-left-fullhd has-text-left-tablet has-text-center-mobile" style="text-align: left;">
            
            <p id="description" class="content is-small has-text-weight-medium is-uppercase">
              LinkVortex machine from Hack The Box. The process includes port scanning, web technology identification, fuzzing for hidden directories, exploiting vulnerabilities in Ghost CMS (CVE-2023-40028), and privilege escalation through the clean_symlink.sh script. The final goal was to escalate privileges and capture the root flag.
            </p>
            <p class="subtitle is-uppercase is-6 has-text-weight-normal has-text-black-ter">LAB LINK: 
              <b><a href="https://app.hackthebox.com/machines/LinkVortex" target="page.enlace">LinkVortex</a></b>
            </p>
            
            <!-- Dificultad -->
            <p class="subtitle is-6 is-uppercase has-text-weight-normal has-text-black-ter">Difficulty: 
              <b>
                <span class="tag difficulty Easy">
                  Easy
                </span>
              </b>
            </p>

            <!-- Sistema Operativo -->
            
            <p class="subtitle is-6 is-uppercase has-text-weight-normal has-text-black-ter">Operating System: 
              <b>Linux</b>
            </p>
            

            <!-- Skills -->
            
          </div>
        </div>
        <div class="content has-text-justified-desktop has-text-justified-fullhd has-text-justified has-text-justified-tablet has-text-left-mobile">
          <p><p>To begin with, let’s perform a port scan to identify which ports are open:</p>

<div style="text-align:center;">
 <div class="code-container">
    <div class="code-header">
      Bash
      <button class="copy-button" data-code="bash">Copy</button>
    </div>
    <pre><code class="language-bash">sudo nmap -p- -open -sS -n -Pn -vvv --min-rate 5000 &lt;target_IP&gt; -oN filename</code></pre>
  </div>
</div>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/1.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>As you can see above, we found two ports → 22 (<em>SSH</em>) and 80 (<em>HTTP</em>).</p>

<p>Now, let’s perform a more exhaustive scan using the most common scripts (<code>-sCV</code>) to identify the versions and services running on these ports:</p>
<div style="text-align:center;">
 <div class="code-container">
    <div class="code-header">
      Bash
      <button class="copy-button" data-code="bash">Copy</button>
    </div>
    <pre><code class="language-bash">sudo nmap -sCV &lt;target_IP&gt; -oN filename</code></pre>
  </div>
</div>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/2.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>By using <code>Whatweb</code> (Wappalyzer for terminals), we can check the technologies used by the web application.</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/3.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:2000px;" />
</div>

<p>Now, using a fuzzer, in this case, <code>wfuzz</code> we can look for hidden directories on this website.</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/4.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>We found that the <code class="language-plaintext highlighter-rouge">robots.txt</code> file is accessible, and it can provide us information if it’s not properly configured.</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/5.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>Indeed, we found a hidden directory called <code class="language-plaintext highlighter-rouge">/ghost</code>, and if we access it, we will find a login panel.</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/6.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>At the same time, we can perform a subdomain scan, as it could reveal useful information.</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/7.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>We found the subdomain <code class="language-plaintext highlighter-rouge">dev</code>, so if we access it, we will find the following:</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/8.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>As you can see above, we are facing a website that a first glance doesn’t offer much. Just like at the beginning, we can fuzz the website to look for hidden directories:</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/9.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>Nice! We found the hidden directorio <code class="language-plaintext highlighter-rouge">.git</code>, which indicates that it is a version control system directory used by Git to manage a project’s source code.</p>

<p>In addition, we can see some of the project’s directories.</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/10.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:700px;" />
</div>

<p>The most notable directory is <code class="language-plaintext highlighter-rouge">/logs</code>, as it might contain system log information. However, we found a potential user: <code class="language-plaintext highlighter-rouge">dev@linkvortex.htb</code>.</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/11.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>We can make use of this <a href="https://github.com/lijiejie/GitHack/tree/master" target="_blank">GitHub repository</a> to reconstruct the source code from the <code class="language-plaintext highlighter-rouge">/.git</code> directory and discover sensitive information.</p>

<p>A good practice is to read the <em>ReadMe</em> file to understand what the code does.</p>

<p>If you run the script, you will see many lines starting with “<em>[File not found]</em>”, so we can exclude them using the following command line:</p>

<div style="text-align:center;">
 <div class="code-container">
    <div class="code-header">
      Bash
      <button class="copy-button" data-code="bash">Copy</button>
    </div>
    <pre><code class="language-bash">python3 GitHack.py http://dev.linkvortex.htb/.git | grep -v '^\[File not found\]'</code></pre>
  </div>
</div>

<p>As a result, we have this <em>JavaScript</em> script:</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/12.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>We can check the information of this script:</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/13.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>We found this password <code class="language-plaintext highlighter-rouge">OctopiFociPilfer45</code>, so we can use either <code class="language-plaintext highlighter-rouge">dev@linkvortex.htb:OctopiFociPilfer45</code> or <code class="language-plaintext highlighter-rouge">admin@linkvortex.htb:OctopiFociPilfer45</code> as credentials, since we are located in the <code class="language-plaintext highlighter-rouge">/admin</code> directory, which could be a potential user.</p>

<p>Now, we can try logging in with these credentials:</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/14.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:600px;" />
</div>

<p>If we try with <code class="language-plaintext highlighter-rouge">admin</code>, we can successfully login.</p>

<p>With <code class="language-plaintext highlighter-rouge">Wappalyzer</code>, we can identify the technologies used by the website in order to search for potential vulnerabilities to exploit:</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/15.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>We see that the website is using a <em>Ghost CMS</em> version 5.58, so we can try to search for vulnerabilities related to this CMS version.</p>

<p>On GitHub, we can find this  exploit for the vulnerability CVE-2023-40028, which allows arbitrary file reading: <a href="https://github.com/0xDTC/Ghost-5.58-Arbitrary-File-Read-CVE-2023-40028." target="_blank">EXPLOIT!</a></p>

<p>This exploit allows us to remotely read any file, as long as the file does not have elevated privileges, such as root, for example.</p>

<p>To do this, you need to modify the URL inside the script to point to the path of your CMS:</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/16.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>Now, we can execute the script with the credentials you obtained earlier to authenticate:</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/17.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>We found the user <code class="language-plaintext highlighter-rouge">node</code> by viewing the content of <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file, but we cannot see the content of the <code class="language-plaintext highlighter-rouge">/etc/shadow</code> file since it has root privileges.</p>

<p>Since we want to find a way to access the machine, let’s gather information from it.</p>

<p>We can look for the Ghost configuration file, which is this case will be located at → <code class="language-plaintext highlighter-rouge">var/lib/ghost/config.production.json</code></p>

<table>
  <tr>
    <td>
      <div style="text-align: center;">
        <img src="/assets/images/Rooms/HTB/LinkVortex/18.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
      </div>
    </td>
    <td>
    <div style="text-align: center;">
      <img src="/assets/images/Rooms/HTB/LinkVortex/19.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:400px;" />
    </div>
    </td>
  </tr>
</table>

<p>Great! We found the user <code class="language-plaintext highlighter-rouge">bob@linkvortex.htb:fibber-talented-worth</code>. We can try using these credentials to access the server via <em>SSH</em>:</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/21.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>Awesome! We are in. We can use the command <code class="language-plaintext highlighter-rouge">export TERM=xterm</code> to be able to use CTRL+L.</p>

<p>Now, our goal is to find the flags, so we begin by looking for the <em>user flag</em>:</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/22.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>After that, let’s escalate privileges to access the <em>root flag</em>.</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/23.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>We observe that the script <code class="language-plaintext highlighter-rouge">clean_symlink.sh</code> runs as root without requiring a password for any file with ‘.png’ extension.</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/24.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:700px;" />
</div>

<p>This script handles symbolic links pointing to pictures with the ‘.png’ extension. In addition, it quarantines symbolic links that point to directories such as <code class="language-plaintext highlighter-rouge">/root</code> or <code class="language-plaintext highlighter-rouge">/etc</code>.</p>

<p>Therefore, we can create a new symbolic link pointing to any file in those two directories to read its content.</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/25.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:700px;" />
</div>

<p>This happens because, when they are sent to the <code class="language-plaintext highlighter-rouge">/var/quarantined</code> directory, we have full permissions since we are the owners of that directory.</p>

<p>Therefore, we will create a new ‘.txt’ file that points to the <code class="language-plaintext highlighter-rouge">/root/root.txt</code> file. Then, this new file will be referenced through a symbolic link to one with ‘.png’ extension so that can executes and allows to escalate privileges.</p>

<p>Finally, it will be sent to the previously mentioned directory, where we will retrieve the obtain the contents of the file in question.</p>

<div style="text-align: center;">
  <img src="/assets/images/Rooms/HTB/LinkVortex/26.png" alt="Untitled" onclick="openModal(this.src)" style="width:100%; max-width:910px;" />
</div>

<p>Great! We have obtained the <em>root flag</em> and, therefore, we completed the machine.</p>

<hr />

<div style="text-align: center;">
  <a href="https://www.hackthebox.com/achievement/machine/1157775/638" target="_blank">
    <img src="/assets/images/Rooms/HTB/LinkVortex/27.png" alt="Hack The Box Achievement" style="width:100%; max-width:300px;" />
  </a>
</div>
</p>
        </div>
        
        <div class="disqus-comments" id="disqus_thread"></div>
        
      </div>
    </div>
  </section>
  <footer id="footer">
    <!--Footer Button-->
    <div class="container has-text-centered has-background-grey-darker" id="backtotop">
        <a class="has-text-white" onclick="window.scroll(0,0)">BACK TO TOP</a>
    </div>
    <!--Footer Main Section-->
    <!-- <div class="has-background-grey-darker">
        <div class="container columns">
            Name Section-->
            <!-- <div class="column has-text-left-desktop has-text-centered-mobile">
                <a href="http://localhost:4000/#about">
                    <div class="columns">
                        <div class="column is-one-fifth-desktop is-one-fifth-fullhd is-one-quarter-tablet">
                            <figure class="image is-64x64">
                                <img class="is-rounded" src="/assets/images/me.png">
                            </figure>
                        </div>
                        <div class="column is-marginless">
                            <h5 class="has-text-grey-lighter">Jose Luis Venega</h5>
                            <div class="content has-text-grey">
                                <p>Hi! I'm Jose Luis Venega, a Computer Engineering student at the Universi...</p>
                            </div>
                        </div>
                    </div>
                </a>
            </div> -->

            <!--Link Section
            <div class="column has-text-white">
                <h3>More Links</h3>
                
                <li>
                    <a target="_blank" href="http://localhost:4000/feed.xml">Subscribe via RSS</a>
                </li>
            </div> -->

            <!--Blog-post Section-->
            <!-- <div class="column has-text-white">
                <h3>Recent Posts</h3>
                
                <li>
                    <a href="http://localhost:4000/blog/Alert">Alert</a>
                </li>
                
                <li>
                    <a href="http://localhost:4000/blog/LinkVortex">LinkVortex</a>
                </li>
                
                <li>
                    <a href="http://localhost:4000/blog/Cicada">Cicada</a>
                </li>
                
            </div>
        </div> -->
    </div>
    <div class="has-background-black has-text-centered has-text-white" id="credits">
        <i class="far fa-copyright"></i> 2025 | A Theme made by <a href="https://github.com/Joseeelv" target="_blank" rel="noopener noreferrer">Joseeelv</a> Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>
    </div>
</footer>

  <!-- Modal -->
  <div id="myModal" class="modal">
    <span class="close" onclick="closeModal()">&times;</span>
    <img class="modal-content" id="img01">
  </div>

  <!-- Prism.js Script -->
  <script src="../prism.js"></script>
  <script>
    function copyToClipboard(event) {
      const button = event.target;
      const codeContainer = button.closest('.code-container');
      const codeElement = codeContainer.querySelector('code');
    
      if (!codeElement) {
        console.error('No se encontró el elemento <code> para copiar.');
        return;
      }

      const code = codeElement.textContent;

      navigator.clipboard.writeText(code).then(() => {
        button.textContent = 'Copied!';

        setTimeout(() => {
          button.textContent = 'Copy';
        }, 2000); // 2000 ms = 2 segundos

      }).catch(err => {
        console.error('Error al copiar al portapapeles: ', err);
      });
    }

    document.querySelectorAll('.copy-button').forEach(button => {
      button.addEventListener('click', copyToClipboard);
    });

    function openModal(imgSrc) {
      var modal = document.getElementById("myModal");
      var modalImg = document.getElementById("img01");

      modal.style.display = "block";
      setTimeout(function() {
        modal.classList.add('show');
      }, 10); // Delay to trigger the animation
      modalImg.src = imgSrc;
    }

    function closeModal(event) {
      if (event) event.stopPropagation();
      var modal = document.getElementById("myModal");
      modal.classList.remove('show');
      setTimeout(function() {
        modal.style.display = "none";
      }, 300); // Match this duration with the CSS animation duration
    }

    window.onclick = function(event) {
      var modal = document.getElementById("myModal");
      if (event.target == modal) {
        closeModal();
      }
    }
  </script>
</body>
</html>
